<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.146">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>EFI-TERN Challenge - Instructions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: white;
      }

      .quarto-title-block .quarto-title-banner {
        color: white;
background-image: url(img/tern_header.png);
background-size: cover;
      }
</style>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">EFI-TERN Challenge</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./instructions.html" rel="" target="" aria-current="page"><i class="bi bi-info-square" role="img">
</i> 
 <span class="menu-text">Instructions</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./terrestrial.html" rel="" target=""><i class="bi bi-tree-fill" role="img">
</i> 
 <span class="menu-text">Submitted forecasts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./catalog.html" rel="" target=""><i class="bi bi-book" role="img">
</i> 
 <span class="menu-text">Catalog</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page-left">
      <h1 class="title">Instructions</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta column-page-left">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#challenge" id="toc-challenge" class="nav-link" data-scroll-target="#challenge">Challenge</a></li>
  <li><a href="#data-targets" id="toc-data-targets" class="nav-link" data-scroll-target="#data-targets">Data: Targets</a>
  <ul class="collapse">
  <li><a href="#net-ecosystem-exchange" id="toc-net-ecosystem-exchange" class="nav-link" data-scroll-target="#net-ecosystem-exchange">Net ecosystem exchange</a></li>
  <li><a href="#latent-heat-flux" id="toc-latent-heat-flux" class="nav-link" data-scroll-target="#latent-heat-flux">Latent heat flux</a></li>
  <li><a href="#focal-sites" id="toc-focal-sites" class="nav-link" data-scroll-target="#focal-sites">Focal sites</a></li>
  <li><a href="#target-data-calculation" id="toc-target-data-calculation" class="nav-link" data-scroll-target="#target-data-calculation">Target data calculation</a></li>
  </ul></li>
  <li><a href="#timeline" id="toc-timeline" class="nav-link" data-scroll-target="#timeline">Timeline</a></li>
  <li><a href="#flux-data-latency" id="toc-flux-data-latency" class="nav-link" data-scroll-target="#flux-data-latency">Flux data latency</a></li>
  <li><a href="#submissions" id="toc-submissions" class="nav-link" data-scroll-target="#submissions">Submissions</a>
  <ul class="collapse">
  <li><a href="#steps-to-submitting" id="toc-steps-to-submitting" class="nav-link" data-scroll-target="#steps-to-submitting">Steps to submitting</a></li>
  </ul></li>
  <li><a href="#meteorological-inputs-for-modeling" id="toc-meteorological-inputs-for-modeling" class="nav-link" data-scroll-target="#meteorological-inputs-for-modeling">Meteorological inputs for modeling</a></li>
  <li><a href="#useful-functions" id="toc-useful-functions" class="nav-link" data-scroll-target="#useful-functions">Useful functions</a></li>
  <li><a href="#null-models" id="toc-null-models" class="nav-link" data-scroll-target="#null-models">Null models</a></li>
  <li><a href="#evaluation" id="toc-evaluation" class="nav-link" data-scroll-target="#evaluation">Evaluation</a></li>
  <li><a href="#design-team" id="toc-design-team" class="nav-link" data-scroll-target="#design-team">Design team</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/eco4cast/tern4cast/edit/main/instructions.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/eco4cast/tern4cast/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page-left" id="quarto-document-content">




<p><strong>What:</strong> Net ecosystem exchange of CO2 and evapotranspiration in terrestrial ecosystems</p>
<p><strong>Where</strong>: 2 TERN sites in Australia</p>
<p><strong>When</strong>: Daily forecasts for at least 30 days in the future are accepted at any time. New forecast submissions are accepted daily. The only requirement is that submissions are predictions of the future at the time the forecast is submitted.</p>
<p><strong>Why:</strong> Carbon and water cycling are fundamental for climate and water regulation services provided by ecosystems</p>
<p><strong>Who</strong>: Open to any individual or team that registers</p>
<p><strong>How</strong>: Upload to our submissions system (instructions below)</p>
<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>The exchange of water and carbon dioxide between the atmosphere and the land is akin to earth’s terrestrial ecosystems breathing rate and lung capacity. One of the best ways to monitor changes in the amount of carbon and water in an ecosystem is the eddy-covariance method. This method observes the net amount of carbon and water entering and exiting ecosystems at half-hourly timesteps, which is important because it can provide information on ecosystem processes such as photosynthesis, respiration, and transpiration, their sensitivities to ongoing climate and land use change, and greenhouse gas budgets for carbon accounting and natural climate solutions. Forecasts of carbon uptake and release along with water use can provide insights into the future production of food, fiber, timber, and carbon credits. Additionally, forecasts will highlight the influence that stress and disturbance have on carbon and water cycling.</p>
</section>
<section id="challenge" class="level2">
<h2 class="anchored" data-anchor-id="challenge">Challenge</h2>
<p>This forecasting challenge asks teams to forecast net ecosystem exchange of carbon dioxide (NEE) and latent heat flux of evapotranspiration (LE) across 2 TERN sites with differing climates. Forecasts of daily time steps over the next 30 days. Weather forecasts from NOAA Global Ensemble Forecast System are provided to use as model drivers (if the forecasting model uses meteorological inputs). Forecasts can be submitted daily</p>
<p>Teams are asked to submit their forecast of NEE and LE, along with uncertainty estimates. Any existing NEE and LE may be used to build and improve the forecast models. Other data can be used as inputs to the forecasting model.</p>
</section>
<section id="data-targets" class="level2">
<h2 class="anchored" data-anchor-id="data-targets">Data: Targets</h2>
<p>The challenge uses the following TERN data products:</p>
<p>https://portal.tern.org.au/results?topicTerm=flux</p>
<p>A file with previously released TERN data that has been processed into “targets” is provided below. The same processing will be applied to new data that are used for forecast evaluation.</p>
<section id="net-ecosystem-exchange" class="level3">
<h3 class="anchored" data-anchor-id="net-ecosystem-exchange">Net ecosystem exchange</h3>
<p><strong>Definition</strong></p>
<p>Net ecosystem exchange (NEE) is the net movement of carbon dioxide from the atmosphere to the ecosystem. At the 30-minute time resolution it is reported as <span class="math inline">\(\mu\)</span>mol CO<sub>2</sub> m<sup>-2</sup> s<sup>-1</sup>. At the daily time resolution, it is reported as g C m<sup>-2</sup> day<sup>-1</sup>. Negative values correspond to an ecosystem absorbing CO<sup>2</sup> from the atmosphere, positive values correspond to an ecosystem emitting CO<sub>2</sub> to the atmosphere.</p>
<p><strong>Motivation</strong></p>
<p>NEE quantifies the net exchange of CO<sub>2</sub> between the ecosystem and the atmosphere over a daily time period. Making daily predictions will allow us to rapidly assess skill and provide information in a timeframe pertinent to inform and implement natural resource management.</p>
</section>
<section id="latent-heat-flux" class="level3">
<h3 class="anchored" data-anchor-id="latent-heat-flux">Latent heat flux</h3>
<p><strong>Definition</strong></p>
<p>Latent heat flux is the movement of water as water vapor from the ecosystem to the atmosphere. It is reported as W m<sup>-2</sup> (equivalent to J m<sup>-2</sup> s<sup>-1</sup>). At the daily time resolution, it is reported as mean W m<sup>-2</sup>. Positive values correspond to a transfer of water vapor from the ecosystem to the atmosphere.</p>
<p><strong>Motivation</strong></p>
<p>Latent heat measures the water loss from an ecosystem to the atmosphere through evapotranspiration (transpiration through plants + evaporation from surfaces).</p>
<p>Forecasting latent heat (evapotranspiration) can provide insights into water stress for plants and the efficiency that plants use water relative to NEE, and to the amount of liquid water remaining in the soil for soil moisture forecasting</p>
</section>
<section id="focal-sites" class="level3">
<h3 class="anchored" data-anchor-id="focal-sites">Focal sites</h3>
<p>Information on the sites can be found here:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>site_data <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/eco4cast/tern4cast/main/tern_field_site_metadata.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(data_url))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 13%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">site</th>
<th style="text-align: left;">site_id</th>
<th style="text-align: left;">fluxnet_id</th>
<th style="text-align: right;">latitude</th>
<th style="text-align: right;">longitude</th>
<th style="text-align: right;">elevation</th>
<th style="text-align: right;">mat</th>
<th style="text-align: right;">map</th>
<th style="text-align: left;">world_ecoregion</th>
<th style="text-align: left;">data_url</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Boyagin</td>
<td style="text-align: left;">ABOY</td>
<td style="text-align: left;">AU-Boy</td>
<td style="text-align: right;">-32.4771</td>
<td style="text-align: right;">116.9386</td>
<td style="text-align: right;">484</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">https://dap.ozflux.org.au/thredds/dodsC/ozflux/sites/Boyagin/L3/neon_efi/Boyagin_L3_EFI.nc</td>
</tr>
<tr class="even">
<td style="text-align: left;">Calperum</td>
<td style="text-align: left;">ACPR</td>
<td style="text-align: left;">AU-Cpr</td>
<td style="text-align: right;">-34.0027</td>
<td style="text-align: right;">140.5877</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">17.9</td>
<td style="text-align: right;">301</td>
<td style="text-align: left;">Mediterranean woodlands</td>
<td style="text-align: left;">https://dap.ozflux.org.au/thredds/dodsC/ozflux/sites/Calperum/L3/neon_efi/Calperum_L3_EFI.nc</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="target-data-calculation" class="level3">
<h3 class="anchored" data-anchor-id="target-data-calculation">Target data calculation</h3>
<p>To create the data for evaluation (and training) for NEE and LE we extract NEE and LE that pass the turbulence quality control flags provided by TERN and has flux values between -50 and 50 umol CO2 m<sup>-2</sup> s<sup>-1</sup>.</p>
<p>To evaluate daily flux forecasts, we select only days with at least 24 of 48 half hours that pass the quality control flags. For these days, we average the half-hours and convert carbon to daily units (gC/m2/day). The daily data table has the following columns.</p>
<ul>
<li><code>datetime</code>: YYYY-MM-DD (the day is determined using UTC time)<br>
</li>
<li><code>site_id</code>: NEON site code (e.g., BART)<br>
</li>
<li><code>variable</code>: <code>nee</code> (g C m<sup>-2</sup> day<sup>-1</sup>) or <code>le</code> (W m<sup>-2</sup>)</li>
<li><code>observation</code>: value for the variable</li>
</ul>
<p>Here is the download link and format of the <code>terrestrial_daily</code> target file</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"https://data.ecoforecast.org/tern4cast-targets/terrestrial_daily/terrestrial_daily-targets.csv.gz"</span>, <span class="at">guess_max =</span> <span class="fl">1e6</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13,746 × 4
   datetime   site_id variable observation
   &lt;date&gt;     &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
 1 2010-07-30 ACPR    le            48.8  
 2 2010-07-31 ACPR    le            22.6  
 3 2010-07-31 ACPR    nee           -0.296
 4 2010-08-01 ACPR    le            69.6  
 5 2010-08-01 ACPR    nee           -1.27 
 6 2010-08-02 ACPR    le            21.1  
 7 2010-08-02 ACPR    nee           -0.375
 8 2010-08-03 ACPR    le            15.7  
 9 2010-08-03 ACPR    nee           -0.563
10 2010-08-04 ACPR    le             9.48 
# ℹ 13,736 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="timeline" class="level2">
<h2 class="anchored" data-anchor-id="timeline">Timeline</h2>
<p>Forecasts for a minimum of 30 days in the forecast can be submitted daily. New forecasts can be submitted daily as new weather forecasts and observations (e.g., NEE) become available. The key is that submissions are predictions of the future.</p>
<p>Daily submissions are allowed and encouraged as new observations and weather forecasts become available, therefore the automation of forecast generation may be ideal. There are many ways to automate scripts that are written to download observations and meteorology drivers, generate forecasts, and submit forecasts.</p>
</section>
<section id="flux-data-latency" class="level2">
<h2 class="anchored" data-anchor-id="flux-data-latency">Flux data latency</h2>
<p>There is approximately 2 days between data collection and availability in the targets file.</p>
</section>
<section id="submissions" class="level2">
<h2 class="anchored" data-anchor-id="submissions">Submissions</h2>
<p>The required names for forecasted variables: <code>nee</code> or <code>le</code>.</p>
<p>The required time unit: <code>YYYY-MM-DD</code></p>
<p>The following provides the requirements for the format of the forecasts that will be submitted. It is important to follow these format guidelines in order for your submitted forecasts to pass a set of internal checks that allow the forecast to be visualized and scored correctly.</p>
<section id="steps-to-submitting" class="level3">
<h3 class="anchored" data-anchor-id="steps-to-submitting">Steps to submitting</h3>
<p>We provide an overview of the steps for submitting with the details below:</p>
<ol type="1">
<li>Submit <a href="https://nd.qualtrics.com/jfe/form/SV_9MJ29y2xNrBOjqZ" target="_blank">registration and model overview</a> for the model using a web form.&nbsp;</li>
<li>Generate forecast with required columns. There are three options for the file format described below.<br>
</li>
<li>Write the forecast to a file that follows the standardized naming format.<br>
</li>
<li>Submit forecast (preferably using the submission function that we provide)/<br>
</li>
</ol>
<section id="step-1-forecast-file-format" class="level4">
<h4 class="anchored" data-anchor-id="step-1-forecast-file-format">Step 1: Forecast file format</h4>
<p>The file is a csv format with the following columns:</p>
<ul>
<li><code>datetime</code>: forecast timestamp. Format <code>%Y-%m-%d</code>.<br>
</li>
<li><code>reference_datetime</code>: The start of the forecast; this should be 0 times steps in the future. This should only be one value of <code>reference_datetime</code> in the file. Format is <code>%Y-%m-%d %H:%M:%S</code> for terrestrial_30min theme and <code>%Y-%m-%d</code> for all other themes.</li>
<li><code>site_id</code>: NEON code for site</li>
<li><code>family</code> name of the probability distribution that is described by the parameter values in the parameter column; only <code>normal</code> or <code>ensemble</code> are currently allowed.</li>
<li><code>parameter</code> required to be the string <code>mu</code> or <code>sigma</code> (see note below about parameter column) or the number of the ensemble member.</li>
<li><code>variable</code>: standardized variable name for the theme</li>
<li><code>prediction</code>: forecasted value for the parameter in the parameter column</li>
<li><code>model_id</code>: the short name of the model defined as the model_id in the file name (see below) and in your metadata. The model_id should have no spaces.</li>
</ul>
<p>The time unit (i.e., date or date-time) should correspond to the time unit of the theme-specific target file (see Theme description). All datetimes with time zones should use UTC as the time zone.</p>
<p>For a parametric forecast, the <code>family</code> column uses the word <code>normal</code> to designate a normal distribution and the parameter column must have values of <code>mu</code> and <code>sigma</code> for each forecasted variable, site_id, and time.</p>
<p>If you are submitting a forecast that does not have a normal distribution we recommend using the ensemble format and sampling from your non-normal distribution to generate a set of ensemble members that represents your distribution.</p>
<p>We aim to support more distributions beyond the normal in the distribution format file (e.g., log-normal distribution to support zero-bounded forecast submissions). Please check back at this site for updates on the list of supported distributions.</p>
<p>Here is an example of a forecast that uses a normal distribution:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"https://data.ecoforecast.org/neon4cast-forecasts/raw/aquatics/aquatics-2022-11-07-climatology.csv.gz"</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 68 × 8
   datetime   variable    parameter family model_id   reference_datetime site_id
   &lt;date&gt;     &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt;      &lt;date&gt;             &lt;chr&gt;  
 1 2022-11-07 temperature mu        normal GLEON_phy… 2022-11-07         BARC   
 2 2022-11-07 temperature sigma     normal GLEON_phy… 2022-11-07         BARC   
 3 2022-11-08 temperature mu        normal GLEON_phy… 2022-11-07         BARC   
 4 2022-11-08 temperature sigma     normal GLEON_phy… 2022-11-07         BARC   
 5 2022-11-09 temperature mu        normal GLEON_phy… 2022-11-07         BARC   
 6 2022-11-09 temperature sigma     normal GLEON_phy… 2022-11-07         BARC   
 7 2022-11-10 temperature mu        normal GLEON_phy… 2022-11-07         BARC   
 8 2022-11-10 temperature sigma     normal GLEON_phy… 2022-11-07         BARC   
 9 2022-11-11 temperature mu        normal GLEON_phy… 2022-11-07         BARC   
10 2022-11-11 temperature sigma     normal GLEON_phy… 2022-11-07         BARC   
# ℹ 58 more rows
# ℹ 1 more variable: prediction &lt;dbl&gt;</code></pre>
</div>
</div>
<p>For an ensemble (or sample) forecast, the <code>family</code> column uses the word <code>ensemble</code> to design that it is a ensemble forecast and the parameter column is the ensemble member number (<code>1</code>, <code>2</code>, <code>3</code> …)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"https://data.ecoforecast.org/neon4cast-forecasts/raw/aquatics/aquatics-2022-11-07-persistenceRW.csv.gz"</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 523,600 × 8
   model_id      datetime   reference_datetime site_id family parameter variable
   &lt;chr&gt;         &lt;date&gt;     &lt;date&gt;             &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;   
 1 persistenceRW 2022-11-08 2022-11-07         BARC    ensem…         1 chla    
 2 persistenceRW 2022-11-09 2022-11-07         BARC    ensem…         1 chla    
 3 persistenceRW 2022-11-10 2022-11-07         BARC    ensem…         1 chla    
 4 persistenceRW 2022-11-11 2022-11-07         BARC    ensem…         1 chla    
 5 persistenceRW 2022-11-12 2022-11-07         BARC    ensem…         1 chla    
 6 persistenceRW 2022-11-13 2022-11-07         BARC    ensem…         1 chla    
 7 persistenceRW 2022-11-14 2022-11-07         BARC    ensem…         1 chla    
 8 persistenceRW 2022-11-15 2022-11-07         BARC    ensem…         1 chla    
 9 persistenceRW 2022-11-16 2022-11-07         BARC    ensem…         1 chla    
10 persistenceRW 2022-11-17 2022-11-07         BARC    ensem…         1 chla    
# ℹ 523,590 more rows
# ℹ 1 more variable: prediction &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="step-3-submission-process" class="level4">
<h4 class="anchored" data-anchor-id="step-3-submission-process">Step 3: Submission process</h4>
<p>Individual forecast files can be uploaded any time.</p>
<p><strong>The correct file name and format is critical for the automated processing of submissions</strong></p>
<p>Teams can submit their forecast csv files through an R function.</p>
<p>We have developed a function called <code>submit()</code> that is available in this GitHub repo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(aws.s3)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"https://raw.githubusercontent.com/eco4cast/tern4cast/main/R/submit.R"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>forecast_file <span class="ot">=</span> <span class="st">"theme_name-forecast-year-month-day-model_id.csv"</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">submit</span>(<span class="at">forecast_file =</span> forecast_file,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">metadata =</span> <span class="cn">NULL</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ask =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Alternatively, if you using another programming language, you can submit using AWS S3-like tools (i.e., <code>aws.s3</code> R package) to the <code>tern4cast-submissions</code> bucket at the <code>data.ecoforecast.org</code> endpoint.</p>
<p>Submissions need to adhere to the forecast format that is provided above, including the file naming convention. Our cyberinfrastructure automatically evaluates forecasts and relies on the expected formatting. Contact eco4cast.initiative@gmail.com if you experience technical issues with submitting.</p>
</section>
</section>
</section>
<section id="meteorological-inputs-for-modeling" class="level2">
<h2 class="anchored" data-anchor-id="meteorological-inputs-for-modeling">Meteorological inputs for modeling</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>s3 <span class="ot">&lt;-</span> arrow<span class="sc">::</span><span class="fu">s3_bucket</span>(<span class="st">"tern4cast-drivers/noaa/gefs-v12/stage1"</span>, <span class="at">endpoint_override =</span> <span class="st">"data.ecoforecast.org"</span>, <span class="at">anonymous =</span> <span class="cn">TRUE</span>) </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>weather <span class="ot">&lt;-</span> arrow<span class="sc">::</span><span class="fu">open_dataset</span>(s3) <span class="sc">|&gt;</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(reference_datetime <span class="sc">==</span> <span class="st">"2023-05-25"</span>, </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>         site_id <span class="sc">==</span> <span class="st">"ABOY"</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">collect</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="useful-functions" class="level2">
<h2 class="anchored" data-anchor-id="useful-functions">Useful functions</h2>
<p>We run a validator script when processing the submissions. If your submission does not meet the file standards above, you can run a function that provides information describing potential issues. The forecast file needs to be in your local working directory or you need to provide a full path to the file</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"https://raw.githubusercontent.com/eco4cast/tern4cast/main/R/forecast_output_validator.R"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">forecast_output_validator</span>(<span class="st">"phenology-2022-09-01-persistenceRW.csv.gz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="null-models" class="level2">
<h2 class="anchored" data-anchor-id="null-models">Null models</h2>
<p>Two null models are automatically generated each day - these are simple baseline models. The persistence null model uses the most recent measurement of nee or le and predicts that the values will be constant in the future. The climatology null model forecasts that the nee or lee will be equal to the historical mean of that day of the year. We apply both the persistence and climatology models to the daily fluxes.</p>
</section>
<section id="evaluation" class="level2">
<h2 class="anchored" data-anchor-id="evaluation">Evaluation</h2>
<p>Forecasts will be scored using the continuous ranked probability score (CRPS), a proper scoring rule for evaluating forecasts presented as distributions or ensembles (Gneiting &amp; Raftery 2007). The CRPS compares the forecast probability distribution to that of the validation observation and assigns a score based on both the accuracy and precision of the forecast. We will use the ‘crps_sample’ function from the <code>scoringRules</code> package in R to calculate the CRPS for each forecast.</p>
</section>
<section id="design-team" class="level2">
<h2 class="anchored" data-anchor-id="design-team">Design team</h2>
<p>Terrestrial Ecosystem Research Network <a href="https://www.tern.org.au/" target="_blank">(TERN)</a> has been involved in the design of the challenge. ````</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      try { hash = new URL(url).hash; } catch {}
      const id = hash.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note !== null) {
        try {
          const html = processXRef(id, note);
          instance.setContent(html);
        } finally {
          instance.enable();
          instance.show();
        }
      } else {
        // See if we can fetch this
        fetch(url.split('#')[0])
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.getElementById(id);
          console.log(htmlDoc.body.innerHTML);
          if (note !== null) {
            const html = processXRef(id, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>CC-BY</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/eco4cast/tern4cast">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>